<html><head>
  <!-- <link rel="prerender" href="http://localhost:3000/free"> -->
  <script>
    if(!location.search.includes("nonResponsive")) {
      document.write('<meta name="viewport" content="width=device-width"/>')
    }
  </script>
<script>
  // TODO: How would someone inform Cal SDK of something before that SDK is installed ? We need a separate queue global variable for that.
  // FIXME: Remove import and move to non module script once we have build process that generates sdk-event.js
  window.Cal =
    window.Cal ||
    function Cal() {
      if (!Cal.loaded) {
        Cal.ns = {};
        Cal.q = Cal.q || [];
        // TODO: Remove import once embed.js is built using some build tool.
        import("http://localhost:3000/embed.js").then(function () {
          window.promise = Promise.resolve();
        });
        Cal.loaded = true;
      }
      
      if (arguments[0] === 'init') {
        const api = function () {
          api.q.push(arguments)
        };
        const namespace = arguments[1]
        api.q = api.q || [];
        namespace ? (Cal.ns[namespace] = api) : null;
        return;
      }
      Cal.q.push(arguments)
      return Cal;
    };
    Cal("init")
    
    // Create a namespace "second". It can be accessed as Cal.ns.second with the exact same API as Cal
    Cal("init", "second")

    // Create a namespace "third". It can be accessed as Cal.ns.second with the exact same API as Cal
    Cal("init", "third")
</script>
<style>
  .debug {
    border: 1px solid black;
    margin-bottom: 5px;
  }
</style>
</head>
<body>
  <h3>This page has a non responsive version accessible <a href="?nonResponsive">here</a></h3>
  <div>
    <button data-cal-link="free">Book with Free User</button> 
    <div><i>Corresponding Cal Link is being preloaded. Assuming that it would take you some time to click this as you are reading this text, it would open up super fast. Try switching to slow 3G or create a custom Network configuration which is impossibly slow </span></div>
  </i>

  <div class="debug">
    <h2>
      Default Namespace(Cal)
    </h2>
    <div id="booking-status-">
      <i>You would see last Booking page action in my place</i>
  </div>
  <div id="cal-booking-place-" style="max-height:30vh;overflow:scroll">
    <div>
      if you render booking embed in me, I would not let it be more than 30vh in height. So you would have to scroll to see the entire content
    </div>
  </div>
</div>


  <div class="debug">
    <h2>
      Namespace "second"(Cal.ns.second)
    </h2>
    <div id="booking-status-second">
      <i>You would see last Booking page action in my place</i>
    </div>
  <div id="cal-booking-place-second">
    <div>
      If you render booking embed in me, I won't restrict you. The entire page is yours.
    </div>
  </div>
</div>


  <div class="debug">
    <h2>
      Namespace "third"(Cal.ns.third)
    </h2>
    <div id="booking-status-third">
      <i>You would see last Booking page action in my place</i>
    </div>
  <div id="cal-booking-place-third" style="width:30%" >
    <div>
      If you render booking embed in me, I would not let you be more than 30% wide
    </div>
  </div>
</div>


  <script type="module">
    await window.promise;
    Cal("inline", {
      elementOrSelector: "#cal-booking-place-",
      calendarLink: "pro?case=1",
      config: {
        name: "Hariom Balhara",
        email: "hariombalhara@gmail.com",
        notes: "Test Meeting",
        guests: JSON.stringify(["hariom@gmail.com"]),
        theme: "dark",
      }
    });
    
    Cal.ns.second("inline", {
      elementOrSelector: "#cal-booking-place-second",
      calendarLink: "pro?case=2"
    });

    Cal.ns.third("inline", {
      elementOrSelector: "#cal-booking-place-third",
      calendarLink: "pro?case=3"
    });

  Cal("preload", {
    fullCalendarLink: 'http://localhost:3000/free'
  }); 

  </script>
  <script>
    const callback = function (e) {
      document.getElementById(`booking-status-${e.detail.namespace}`).innerHTML = JSON.stringify(e.detail);
    };
    Cal("on", {
      action: "*", 
      callback
    });
    Cal.ns.second("on", {
      action: "*", 
      callback
    });
    Cal.ns.third("on", {
      action: "*", 
      callback
    });
  </script>
</body>
</html>