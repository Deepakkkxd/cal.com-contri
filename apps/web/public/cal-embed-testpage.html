<html><head>
  <script>
    if(!location.search.includes("nonResponsive")) {
      document.write('<meta name="viewport" content="width=device-width"/>')
    }
  </script>
<script>
  // TODO: How would someone inform Cal SDK of something before that SDK is installed ? We need a separate queue global variable for that.
  // FIXME: Remove import and move to non module script once we have build process that generates sdk-event.js
  window.Cal =
    window.Cal ||
    function Cal() {
      if (!Cal.loaded) {
        Cal.ns = {};
        Cal.q = Cal.q || [];
        // TODO: Remove import once embed.js is built using some build tool.
        import("http://localhost:3000/embed.js").then(function () {
          window.promise = Promise.resolve();
        });
        Cal.loaded = true;
      }
      
      if (arguments[0] === 'init') {
        const api = function () {
          api.q.push(arguments)
        };
        const namespace = arguments[1]
        api.q = api.q || [];
        namespace ? (Cal.ns[namespace] = api) : null;
        return;
      }
      Cal.q.push(arguments)
      return Cal;
    };
    Cal("init")
    Cal("init", "second")
    Cal("init", "third")
</script>
<style>
  .debug {
    border: 1px solid black;
  }
</style>
</head>
<body>
  <strong>This page has a non responsive version accessible at <a href="?nonResponsive"></a></strong>
  <div>
    <h2>
      Booking Status
    </h2>
    <div id="booking-status-">
      You would see Booking status here
    </div>
  </div>
  <div id="cal-booking-place-" style="max-height:30vh;overflow:scroll">
    <div class="debug">
      if you render booking embed in me, I would not let it be more than 30vh in height. So you would have to scroll to see the entire content
    </div>
  </div>

  <div>
    <h2>
      Booking Status
    </h2>
    <div id="booking-status-second">
      You would see Booking status here
    </div>
  </div>
  <div id="cal-booking-place-second">
    <div class="debug">
      If you render booking embed in me, I won't restrict you. The entire page is yours.
    </div>
  </div>


  <div>
    <h2>
      Booking Status
    </h2>
    <div id="booking-status-third">
      You would see Booking status here
    </div>
  </div>
  <div id="cal-booking-place-third" style="width:30%" >
    <div class="debug">
      If you render booking embed in me, I would not let you be more than 30% wide
    </div>
  </div>

  <script type="module">
    await window.promise;
    Cal("inline", {
      elementOrSelector: "#cal-booking-place-",
      calendarLink: "pro?case=1"
    });
    
    Cal.ns.second("inline", {
      elementOrSelector: "#cal-booking-place-second",
      calendarLink: "pro?case=2"
    });

    Cal.ns.third("inline", {
      elementOrSelector: "#cal-booking-place-third",
      calendarLink: "pro?case=3"
    });
  </script>
  <script>
    const callback = function (e) {
      document.getElementById(`booking-status-${e.detail.namespace}`).innerHTML = JSON.stringify(e.detail);
    };
    Cal("on", {
      action: "*", 
      callback
    });
    Cal.ns.second("on", {
      action: "*", 
      callback
    });
    Cal.ns.third("on", {
      action: "*", 
      callback
    });
  </script>
</body>
</html>